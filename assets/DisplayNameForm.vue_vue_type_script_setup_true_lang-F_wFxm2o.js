import{v as S,x as B,y as p,a as c,d as T,m as j,r as m,s as x,o as D,b as N,i as C,f as V,t as E,g as l,k as U,c as z,w as u,e as o,n as M,N as O,B as R}from"./index-CSmqUZEd.js";import{u as q,C as A}from"./CheckmarkOutline-D2H_k4ke.js";import{_ as F,a as J}from"./FormItem-SDgVF96q.js";const _=S(),L=B("audienceStore",{state:()=>({isInitialized:!1,currentPresentationId:p("pinia/audience/currentPresentationId",0),joinedPresentations:p("pinia/audience/joinedPresentations",[]),myEvents:p("pinia/audience/myEvents",[]),publicEvents:p("pinia/audience/publicEvents",[])}),getters:{currentPresentation:e=>e.currentPresentationId?e.joinedPresentations.filter(t=>t.id===e.currentPresentationId)[0]:null},actions:{async initialize(){const{session:e}=c();e!=null&&e.user.id&&(this.isInitialized=!0),this.currentPresentationId&&this.listenToPresentationEvents()},listenToPresentationEvents(){_.listenToPresentationEvents(this.currentPresentationId,e=>{this.myEvents.findIndex(t=>t.id===e.id)>=0&&this.publicEvents.push(e)})},async join(e){if(!e)throw new Error("No join code provided");const{displayName:t,session:s,anonUuid:a}=c(),n=await _.joinPresentation(e,t,s==null?void 0:s.user.id,a);n!=null&&n.id&&(this.currentPresentationId=n.id,this.joinedPresentations.push(n),this.listenToPresentationEvents())},async insertEvent(e,t){const{displayName:s,anonUuid:a,session:n}=c(),i={type:e,created_at:new Date().toISOString(),value:JSON.stringify(t),created_by:n==null?void 0:n.user.id,created_by_alias:s,created_by_anon_uuid:a};await _.createEvent(this.currentPresentationId,i),this.myEvents.push(i)},async react(e,t){await this.insertEvent("reaction",{emoticon:e,emojiText:t})},async comment(e){await this.insertEvent("comment",{commentText:e})},async peekPresentation(e){return await _.peekPresentation(e)}}}),W={key:0},Q=T({__name:"DisplayNameForm",setup(e){const{t}=j(),s=m(null),a=m({displayName:""}),n={displayName:{required:!0,message:()=>t("you_need_to_provide_a_name_message"),trigger:["input","blur"]}},{displayName:i}=x(c()),{setDisplayName:P}=c(),d=m(!1);q(),D(async()=>{i.value?a.value.displayName=i.value:d.value=!0});function b(){d.value=!0}async function y(f){var r;f.preventDefault();try{await((r=s.value)==null?void 0:r.validate()),a.value.displayName&&(P(a.value.displayName),d.value=!1)}catch{}}return(f,r)=>{const v=M,h=F,g=O,k=R,I=J;return d.value?(N(),z(I,{key:1,ref_key:"formRef",ref:s,"label-placement":"top",model:a.value,rules:n,inline:"",onSubmit:y},{default:u(()=>[o(h,{label:l(t)("update_display_name_label"),style:{minWidth:"30rem"},path:"displayName"},{default:u(()=>[o(v,{value:a.value.displayName,"onUpdate:value":r[0]||(r[0]=w=>a.value.displayName=w),placeholder:l(t)("your_display_name_placeholder"),"data-testid":"input-display-name"},null,8,["value","placeholder"])]),_:1},8,["label"]),o(h,null,{default:u(()=>[o(k,{onClick:y},{icon:u(()=>[o(g,null,{default:u(()=>[o(l(A))]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])):(N(),C("p",W,[V(E(l(t)("you_are_participating_as"))+" ",1),U("a",{onClick:b},E(l(i)),1)]))}}});export{Q as _,L as u};
