import{X as L,ab as se,H as ve,I as ee,V as me,K as q,aH as he,M as te,d as m,O as ae,r as p,ag as ne,Y as h,aU as ge,$ as ie,a1 as _e,aV as be,o as F,aL as ye,F as we,ad as le,a5 as xe,T as E,a2 as Ce,aW as ze,S as Se,aX as $e,aY as re,aZ as Oe,a_ as Be,a$ as ke,b as f,i as g,k as S,e as O,w as _,b0 as Y,b1 as N,aS as M,N as Ee,p as A,a as Me,m as I,c as j,g as w,t as z,aP as je,j as ce,f as J,b2 as Pe,aN as oe,aQ as Re,ai as Le,q as Fe}from"./index-CSmqUZEd.js";import{u as Ie}from"./CheckmarkOutline-D2H_k4ke.js";const Te={color:Object,type:{type:String,default:"default"},round:Boolean,size:{type:String,default:"medium"},closable:Boolean,disabled:{type:Boolean,default:void 0}};Object.assign(Object.assign(Object.assign({},L.props),Te),{bordered:{type:Boolean,default:void 0},checked:Boolean,checkable:Boolean,strong:Boolean,triggerClickOnClose:Boolean,onClose:[Array,Function],onMouseenter:Function,onMouseleave:Function,"onUpdate:checked":Function,onUpdateChecked:Function,internalCloseFocusable:{type:Boolean,default:!0},internalCloseIsButtonTag:{type:Boolean,default:!0},onCheckedChange:Function});const Ne=se("n-tag"),Ae=ve&&"loading"in document.createElement("img"),He=(e={})=>{var t;const{root:r=null}=e;return{hash:`${e.rootMargin||"0px 0px 0px 0px"}-${Array.isArray(e.threshold)?e.threshold.join(","):(t=e.threshold)!==null&&t!==void 0?t:"0"}`,options:Object.assign(Object.assign({},e),{root:(typeof r=="string"?document.querySelector(r):r)||document.documentElement})}},K=new WeakMap,G=new WeakMap,X=new WeakMap,We=(e,t,r)=>{if(!e)return()=>{};const o=He(t),{root:s}=o.options;let n;const i=K.get(s);i?n=i:(n=new Map,K.set(s,n));let c,l;n.has(o.hash)?(l=n.get(o.hash),l[1].has(e)||(c=l[0],l[1].add(e),c.observe(e))):(c=new IntersectionObserver(B=>{B.forEach(b=>{if(b.isIntersecting){const C=G.get(b.target),P=X.get(b.target);C&&C(),P&&(P.value=!0)}})},o.options),c.observe(e),l=[c,new Set([e])],n.set(o.hash,l));let d=!1;const x=()=>{d||(G.delete(e),X.delete(e),d=!0,l[1].has(e)&&(l[0].unobserve(e),l[1].delete(e)),l[1].size<=0&&n.delete(o.hash),n.size||K.delete(s))};return G.set(e,x),X.set(e,r),x},Ue=se("n-avatar-group"),De=ee("avatar",`
 width: var(--n-merged-size);
 height: var(--n-merged-size);
 color: #FFF;
 font-size: var(--n-font-size);
 display: inline-flex;
 position: relative;
 overflow: hidden;
 text-align: center;
 border: var(--n-border);
 border-radius: var(--n-border-radius);
 --n-merged-color: var(--n-color);
 background-color: var(--n-merged-color);
 transition:
 border-color .3s var(--n-bezier),
 background-color .3s var(--n-bezier),
 color .3s var(--n-bezier);
`,[me(q("&","--n-merged-color: var(--n-color-modal);")),he(q("&","--n-merged-color: var(--n-color-popover);")),q("img",`
 width: 100%;
 height: 100%;
 `),te("text",`
 white-space: nowrap;
 display: inline-block;
 position: absolute;
 left: 50%;
 top: 50%;
 `),ee("icon",`
 vertical-align: bottom;
 font-size: calc(var(--n-merged-size) - 6px);
 `),te("text","line-height: 1.25")]),Ve=Object.assign(Object.assign({},L.props),{size:[String,Number],src:String,circle:{type:Boolean,default:void 0},objectFit:String,round:{type:Boolean,default:void 0},bordered:{type:Boolean,default:void 0},onError:Function,fallbackSrc:String,intersectionObserverOptions:Object,lazy:Boolean,onLoad:Function,renderPlaceholder:Function,renderFallback:Function,imgProps:Object,color:String}),qe=m({name:"Avatar",props:Ve,setup(e){const{mergedClsPrefixRef:t,inlineThemeDisabled:r}=ae(e),o=p(!1);let s=null;const n=p(null),i=p(null),c=()=>{const{value:a}=n;if(a&&(s===null||s!==a.innerHTML)){s=a.innerHTML;const{value:u}=i;if(u){const{offsetWidth:v,offsetHeight:$}=u,{offsetWidth:y,offsetHeight:U}=a,T=.9,D=Math.min(v/y*T,$/U*T,1);a.style.transform=`translateX(-50%) translateY(-50%) scale(${D})`}}},l=ne(Ue,null),d=h(()=>{const{size:a}=e;if(a)return a;const{size:u}=l||{};return u||"medium"}),x=L("Avatar","-avatar",De,ge,e,t),B=ne(Ne,null),b=h(()=>{if(l)return!0;const{round:a,circle:u}=e;return a!==void 0||u!==void 0?a||u:B?B.roundRef.value:!1}),C=h(()=>l?!0:e.bordered||!1),P=h(()=>{const a=d.value,u=b.value,v=C.value,{color:$}=e,{self:{borderRadius:y,fontSize:U,color:T,border:D,colorModal:de,colorPopover:fe},common:{cubicBezierEaseInOut:pe}}=x.value;let V;return typeof a=="number"?V=`${a}px`:V=x.value.self[ie("height",a)],{"--n-font-size":U,"--n-border":v?D:"none","--n-border-radius":u?"50%":y,"--n-color":$||T,"--n-color-modal":$||de,"--n-color-popover":$||fe,"--n-bezier":pe,"--n-merged-size":`var(--n-avatar-size-override, ${V})`}}),k=r?_e("avatar",h(()=>{const a=d.value,u=b.value,v=C.value,{color:$}=e;let y="";return a&&(typeof a=="number"?y+=`a${a}`:y+=a[0]),u&&(y+="b"),v&&(y+="c"),$&&(y+=be($)),y}),P,e):void 0,W=p(!e.lazy);F(()=>{if(e.lazy&&e.intersectionObserverOptions){let a;const u=ye(()=>{a==null||a(),a=void 0,e.lazy&&(a=We(i.value,e.intersectionObserverOptions,W))});we(()=>{u(),a==null||a()})}}),le(()=>{var a;return e.src||((a=e.imgProps)===null||a===void 0?void 0:a.src)},()=>{o.value=!1});const Z=p(!e.lazy);return{textRef:n,selfRef:i,mergedRoundRef:b,mergedClsPrefix:t,fitTextTransform:c,cssVars:r?void 0:P,themeClass:k==null?void 0:k.themeClass,onRender:k==null?void 0:k.onRender,hasLoadError:o,shouldStartLoading:W,loaded:Z,mergedOnError:a=>{if(!W.value)return;o.value=!0;const{onError:u,imgProps:{onError:v}={}}=e;u==null||u(a),v==null||v(a)},mergedOnLoad:a=>{const{onLoad:u,imgProps:{onLoad:v}={}}=e;u==null||u(a),v==null||v(a),Z.value=!0}}},render(){var e,t;const{$slots:r,src:o,mergedClsPrefix:s,lazy:n,onRender:i,loaded:c,hasLoadError:l,imgProps:d={}}=this;i==null||i();let x;const B=!c&&!l&&(this.renderPlaceholder?this.renderPlaceholder():(t=(e=this.$slots).placeholder)===null||t===void 0?void 0:t.call(e));return this.hasLoadError?x=this.renderFallback?this.renderFallback():xe(r.fallback,()=>[E("img",{src:this.fallbackSrc,style:{objectFit:this.objectFit}})]):x=Ce(r.default,b=>{if(b)return E(ze,{onResize:this.fitTextTransform},{default:()=>E("span",{ref:"textRef",class:`${s}-avatar__text`},b)});if(o||d.src){const C=this.src||d.src;return E("img",Object.assign(Object.assign({},d),{loading:Ae&&!this.intersectionObserverOptions&&n?"lazy":"eager",src:n&&this.intersectionObserverOptions?this.shouldStartLoading?C:void 0:C,"data-image-src":C,onLoad:this.mergedOnLoad,onError:this.mergedOnError,style:[d.style||"",{objectFit:this.objectFit},B?{height:"0",width:"0",visibility:"hidden",position:"absolute"}:""]}))}}),E("span",{ref:"selfRef",class:[`${s}-avatar`,this.themeClass],style:this.cssVars},x,n&&B)}}),Ke=Object.assign(Object.assign({},L.props),{align:String,justify:{type:String,default:"start"},inline:Boolean,vertical:Boolean,reverse:Boolean,size:{type:[String,Number,Array],default:"medium"},wrap:{type:Boolean,default:!0}}),Ct=m({name:"Flex",props:Ke,setup(e){const{mergedClsPrefixRef:t,mergedRtlRef:r}=ae(e),o=L("Flex","-flex",void 0,ke,e,t);return{rtlEnabled:Se("Flex",r,t),mergedClsPrefix:t,margin:h(()=>{const{size:n}=e;if(Array.isArray(n))return{horizontal:n[0],vertical:n[1]};if(typeof n=="number")return{horizontal:n,vertical:n};const{self:{[ie("gap",n)]:i}}=o.value,{row:c,col:l}=$e(i);return{horizontal:re(l),vertical:re(c)}})}},render(){const{vertical:e,reverse:t,align:r,inline:o,justify:s,margin:n,wrap:i,mergedClsPrefix:c,rtlEnabled:l}=this,d=Oe(Be(this),!1);return d.length?E("div",{role:"none",class:[`${c}-flex`,l&&`${c}-flex--rtl`],style:{display:o?"inline-flex":"flex",flexDirection:e&&!t?"column":e&&t?"column-reverse":!e&&t?"row-reverse":"row",justifyContent:s,flexWrap:!i||e?"nowrap":"wrap",alignItems:r,gap:`${n.vertical}px ${n.horizontal}px`}},d):null}}),Ge={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32"},Xe=S("path",{d:"M27.45 15.11l-22-11a1 1 0 0 0-1.08.12a1 1 0 0 0-.33 1L7 16L4 26.74A1 1 0 0 0 5 28a1 1 0 0 0 .45-.11l22-11a1 1 0 0 0 0-1.78zm-20.9 10L8.76 17H18v-2H8.76L6.55 6.89L24.76 16z",fill:"currentColor"},null,-1),Ye=[Xe],zt=m({name:"Send",render:function(t,r){return f(),g("svg",Ge,Ye)}}),Je={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 32 32"},Qe=S("path",{d:"M16 8a5 5 0 1 0 5 5a5 5 0 0 0-5-5zm0 8a3 3 0 1 1 3-3a3.003 3.003 0 0 1-3 3z",fill:"currentColor"},null,-1),Ze=S("path",{d:"M16 2a14 14 0 1 0 14 14A14.016 14.016 0 0 0 16 2zm-6 24.377V25a3.003 3.003 0 0 1 3-3h6a3.003 3.003 0 0 1 3 3v1.377a11.899 11.899 0 0 1-12 0zm13.992-1.451A5.002 5.002 0 0 0 19 20h-6a5.002 5.002 0 0 0-4.992 4.926a12 12 0 1 1 15.985 0z",fill:"currentColor"},null,-1),et=[Qe,Ze],tt=m({name:"UserAvatar",render:function(t,r){return f(),g("svg",Je,et)}});function St(e,t){e instanceof Error?t.error(e.message):console.error(e)}const nt=m({__name:"EventWithIconWrapper",props:{isMine:{type:Boolean},eventType:{}},setup(e){return(t,r)=>{const o=Ee;return f(),g("div",{class:N(`event-wrapper ${t.eventType}`),style:M({flexDirection:t.isMine?"row-reverse":"row"})},[O(o,{class:"type-icon",size:"1.5rem"},{default:_(()=>[Y(t.$slots,"icon",{},void 0,!0)]),_:3}),S("div",null,[Y(t.$slots,"content",{},void 0,!0)])],6)}}}),H=A(nt,[["__scopeId","data-v-b2de9c00"]]);async function Q(e){const t=new Map,{fetchProfile:r}=Me();if(e.created_by_alias)return e.created_by_alias;if(e.created_by&&!t.has(e.created_by)){const o=await r(e.created_by);if(o){const s=o.full_name||o.username;s&&t.set(e.created_by,s)}}return t.has(e.created_by)?t.get(e.created_by):"anonymous"}const rt=m({__name:"EventUserJoined",props:{event:{},isMine:{type:Boolean}},setup(e){const t=e,{t:r}=I();p(t.event);let o=p(void 0);return F(async()=>{o.value=await Q(t.event)}),(s,n)=>(f(),j(H,{"is-mine":s.isMine,"event-type":"user_joined"},{icon:_(()=>[O(w(tt))]),content:_(()=>[S("span",null,z(w(o))+" "+z(w(r)("user_joined")),1)]),_:1},8,["is-mine"]))}}),ot={key:0},st={key:1},at=m({__name:"EventPresentationStartStop",props:{event:{},isMine:{type:Boolean}},setup(e){const t=e,{t:r}=I(),o=p(t.event);return(s,n)=>(f(),j(H,{"event-type":o.value.type,"is-mine":s.isMine},{icon:_(()=>[O(w(je))]),content:_(()=>[o.value.type==="presentation_start"?(f(),g("span",ot,z(w(r)("presentation_was_started")),1)):o.value.type==="presentation_stop"?(f(),g("span",st,z(w(r)("presentation_was_stopped")),1)):ce("",!0)]),_:1},8,["event-type","is-mine"]))}});function it(e){const t=new Set,r=40,o=80;for(let s=0;s<e;s++){const i=`hsl(${Math.floor(s*360/e)}, ${r}%, ${o}%)`;t.add(i)}return t}function lt(e){let t=0;for(let r=0;r<e.length;r++){const o=e.charCodeAt(r);t=(t<<5)-t+o,t|=0}return Math.abs(t)}function ct(e){const t=e.match(/\d+/g);if(t){const[r,o,s]=t.map(Number),n=(r+180)%360,i=100-o,c=100-s;return`hsl(${n}, ${i}%, ${c}%)`}return"white"}function ut(e,t){const r=Array.from(it(t)),s=lt(e)%t,n=r[s],i=ct(n);return{color:n,contrastingColor:i}}const ue=m({__name:"AvatarIcon",props:{name:{type:String}},setup(e){const t=e,{color:r,contrastingColor:o}=ut(t.name||"anonymous",10);function s(n){return n?n.trim().split(/\s+/).map(l=>l.charAt(0).toUpperCase()).join("").substring(0,3):""}return(n,i)=>{const c=qe;return f(),j(c,{style:M({color:w(o),backgroundColor:w(r)}),round:"",size:"small"},{default:_(()=>[J(z(s(e.name)),1)]),_:1},8,["style"])}}}),dt=m({__name:"SpeechBubble",props:{style:{},calloutPosition:{}},setup(e){const t=e,r={backgroundColor:Ie().value.primaryColor,color:"white"},o=h(()=>t.calloutPosition==="right"?"callout-right":"callout-left"),s=h(()=>t.calloutPosition==="right"?{borderColor:`transparent transparent transparent ${r.backgroundColor}`,right:"-10px",left:"auto"}:{borderColor:`transparent ${r.backgroundColor} transparent transparent`,left:"-10px",right:"auto"}),n=h(()=>!t.style||!t.style.backgroundColor?{}:t.calloutPosition==="right"?{borderColor:`transparent transparent transparent ${t.style.backgroundColor}`}:{borderColor:`transparent ${t.style.backgroundColor} transparent transparent`});return(i,c)=>(f(),g("div",{class:N(["speech-bubble",o.value]),style:M([r,i.style])},[Y(i.$slots,"default",{},void 0,!0),S("span",{class:N(["speech-bubble-tail",o.value]),style:M([s.value,n.value])},null,6)],6))}}),ft=A(dt,[["__scopeId","data-v-1eb0ef8d"]]),pt=m({__name:"EventComment",props:{event:{},isMine:{type:Boolean}},setup(e){const t=e;let r=p(void 0);F(async()=>{r.value=await Q(t.event)}),I();const o=p(t.event);return(s,n)=>(f(),j(H,{"is-mine":s.isMine,"event-type":"comment"},{icon:_(()=>[O(ue,{name:w(r)},null,8,["name"])]),content:_(()=>[O(ft,{"callout-position":s.isMine?"right":"left"},{default:_(()=>[J(z(o.value.value.commentText),1)]),_:1},8,["callout-position"])]),_:1},8,["is-mine"]))}}),vt={class:"emoticon"},mt=m({__name:"EventReaction",props:{event:{},isMine:{type:Boolean}},setup(e){const t=e;I();const r=p(t.event);let o=p(void 0);return F(async()=>{o.value=await Q(t.event)}),(s,n)=>(f(),j(H,{"is-mine":s.isMine,"event-type":"reaction"},{icon:_(()=>[O(ue,{name:w(o)},null,8,["name"])]),content:_(()=>[S("span",vt,z(r.value.value.emoticon),1)]),_:1},8,["is-mine"]))}}),ht={class:"creation-info"},gt={key:0},_t=m({__name:"EventRenderer",props:{event:{},isMine:{type:Boolean}},setup(e){I();const t=e,r=p(t.event);function o(n){if(["reaction","comment"].includes(n.type)){if(typeof n.value=="string")return Object.assign({},n,{value:JSON.parse(n.value)});if(typeof n.value=="object")return n}else return n}function s(n){switch(n){case"user_joined":return rt;case"presentation_start":case"presentation_stop":return at;case"comment":return pt;case"reaction":return mt;default:return null}}return h(()=>({display:"flex",flexDirection:t.isMine?"row-reverse":"row",alignItems:"center"})),(n,i)=>(f(),g("div",{style:M({flexDirection:n.isMine?"row-reverse":"row"}),class:"event"},[(f(),j(Pe(s(r.value.type)),{event:o(r.value),isMine:n.isMine},null,8,["event","isMine"])),S("span",ht,[r.value.created_by_alias?(f(),g("span",gt,z(r.value.created_by_alias)+", ",1)):ce("",!0),J(" "+z(new Date(r.value.created_at).toLocaleString()),1)])],4))}}),bt=A(_t,[["__scopeId","data-v-e280c4ca"]]);var R=(e=>(e.NewestTop="newest_top",e.NewestBottom="newest_bottom",e))(R||{});const yt=m({__name:"PresentationEventsTimeline",props:{events:{type:Array,required:!0},myUserId:{type:String,required:!1},myAnonUuid:{type:String,required:!1},sorting:{type:String,default:R.NewestTop,validator:e=>Object.values(R).includes(e)}},setup(e){const t=e,r=p(null);async function o(){await Le();const i=r.value;i&&(i.scrollTop=t.sorting===R.NewestBottom?i.scrollHeight:0)}F(o),le(()=>t.events,o,{deep:!0});function s(i){return i.created_by_anon_uuid===t.myAnonUuid||i.created_by===t.myUserId}const n=h(()=>[...t.events].sort((i,c)=>(new Date(c.created_at).getTime()-new Date(i.created_at).getTime())*(t.sorting===R.NewestBottom?-1:1)));return(i,c)=>{const l=Fe;return f(),g(oe,null,[O(l),S("div",{ref_key:"listContainer",ref:r,class:"list-container","data-testid":"container-event-list"},[(f(!0),g(oe,null,Re(n.value,d=>(f(),g("div",{key:d.id,class:N("list-item"),style:M({flexDirection:s(d)?"row-reverse":"row"})},[O(bt,{event:d,"is-mine":s(d)},null,8,["event","is-mine"])],4))),128))],512)],64)}}}),$t=A(yt,[["__scopeId","data-v-48922443"]]);export{$t as P,zt as S,Ct as _,R as a,St as h};
